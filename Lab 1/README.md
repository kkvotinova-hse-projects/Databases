# Задания для выполнения практических работ по языку SQL
## Вариант 1

### Уровень 1
1. Дана схема базы данных в виде следующих отношений.  С помощью операторов SQL создать логическую структуру соответствующих таблиц для хранения в СУБД, используя известные средства поддержания целостности (NOT NULL, UNIQUE, и т.д.). Обосновать выбор типов данных и используемые средства поддержания целостности. При выборе подходящих типов данных использовать информацию о конкретных значениях полей БД (см. прил.1)

#### ПОКУПАТЕЛЬ
| ИДЕНТИФИКАТОР | ФАМИЛИЯ | РАЙОН ПРОЖИВАНИЯ | СКИДКА, % |
|---------------|:-------:|-----------------:|----------:|

#### МАГАЗИН
| ИДЕНТИФИКАТОР | НАЗВАНИЕ | РАЙОН РАЗМЕЩЕНИЯ | КОМИССИОННЫЕ, % |
|---------------|:--------:|-----------------:|----------------:|

#### КНИГИ
| ИДЕНТИФИКАТОР | НАЗВАНИЕ | СТОИМОСТЬ, РУБ. | СКЛАД | КОЛ-ВО |
|---------------|:--------:|----------------:|------:|-------:|

#### ПОКУПКА
| НОМЕР ЗАКАЗА | ДАТА | ПРОДАВЕЦ | КНИГА | КОЛ-ВО | СУММА, РУБ. |
|--------------|:----:|---------:|------:|-------:|------------:|

2. Ввести в ранее созданные таблицы конкретные данные (см. прил. 1). Использовать скрипт-файл из операторов INSERT или вспомогательную утилиту.
3. Используя оператор SELECT создать запрос для вывода всех строк каждой таблицы. Проверить правильность ввода. При необходимости произвести коррекцию значений операторами INSERT, UPDATE, DELETE. 
4. Создать запросы для вывода:
    1. всех различных названий и стоимостей книг;
    2. всех различных районов, в которых проживают покупатели;
    3. всех различных месяцев, когда производились покупки.
5. Создать запросы для получения информации о:
	1. фамилиях и размере скидки всех покупателей, проживающих в Нижегородском районе;
	2. названиях магазинов Сормовского или Советского районов;
	3. Названиях  и стоимости книг, в которых встречается слово Windows, или стоящих более 20000 руб. Вывод результатов организовать по названию и убыванию цены книг.
6. Для каждой покупки вывести следующие данные:
	1. фамилию покупателя и название магазина, где производилась покупка;
	2. дату, фамилию покупателя, скидку, название и количество купленных книг.
7. Определить:
	1. номер заказа, фамилию покупателя и дату для покупок в которых было продано книг на сумму не меньшую чем 60000 руб.
	2. покупки, сделанные покупателем в своем районе не ранее марта месяца. Вывести фамилию покупателя, район, дату. Произвести сортировку;
	3. магазины, расположенные в любом районе, кроме Автозаводского, где покупали книги те, у кого скидка от 10 до 15 %;
	4. данные по покупке книг (название, район складирования, количество), приобретенных в районе складирования и содержащихся в запасе более 10 штук. Включить данные о стоимости и отсортировать по возрастанию. 
8. Создать запрос для модификации всех значений столбца с суммарной величиной покупки, чтобы он содержал истинную сумму, оплачиваемую покупателем ( с учетом скидки). Вывести новые значения.
9. Расширить таблицу с данными о покупке столбцом, содержащим величину комиссионных, получаемых магазином. Создать запрос для ввода конкретных значений во все строки таблицы покупок.

### Уровень 2
10. Используя операцию IN (NOT IN)  реализовать следующие запросы:
    1. найти покупателей, которые не покупали книг в магазинах Нижегородского района в июне месяце;
	2. найти покупателей, покупавших книги в мае на сумму, меньшую чем купил Потапов в том же месяце;
	3. реализовать запросы заданий 7.а, 7.с.
11. Используя операции ALL-ANY реализовать следующие запросы:
	1. определить покупателя, имеющего минимальную скидку среди тех, кто покупал книги на сумму не менее 50000 руб.
	2. найти покупателя, покупавшего самое большое количество книг;
	3. запрос задания 7.b;
	4. какой из покупателей не покупавший книг в магазинах своего района, делал покупки на минимальную сумму.
12. Используя операцию UNION получить районы проживания покупателей и районы складирования книг.
13. Используя операцию EXISTS ( NOT EXISTS ) реализовать нижеследующие запросы. В случае, если для текущего состояния БД запрос будет выдавать пустое множество строк, требуется указать какие добавления в БД необходимо провести.
	1. какой покупатель покупал все книги в магазине “Наука” или “Знание”;
	2. найти покупателей, покупавших книги во всех магазинах своего района до декабря;
	3. определить покупателей, покупавших все книги, не продающиеся в магазине с максимальным значением комиссионных;
	4. найти среди покупателей тех, кто не покупал с мае книг со ценой более 25000 руб. в магазинах с максимальным размером комиссионных.
14. Реализовать запросы с использованием агрегатных функций:
	1. получить среднюю стоимость покупок, сделанных в магазинах Нижегородского района;
	2. найти количество покупателей, покупавших книги в магазине “Наука”;
	3. найти покупателей имеющих скидку ниже средней;
	4. определить магазины, в которых покупало книги больше покупателей чем в магазине “Наука”.
15. Используя средства группировки реализовать следующие запросы:
	1. вывести данные по суммарной стоимости книг, купленных в каждом магазине;
	2. вывести отчет о суммарной стоимости всех купленных книг по районам, где расположены магазины;
	3. получить сводную информацию о сумме всех покупок, произведенных каждым покупателем;
	4. определить для каждого дня недели количество книг, купленных покупателями не из Советского района .